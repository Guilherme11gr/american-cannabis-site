site_url: https://guilherme11gr.github.io/american-cannabis-site/
search: true

backend:
  name: github
  repo: "Guilherme11gr/american-cannabis-site"
  branch: master
  app_id: Ov23lijkQpNxXSsv4Y0r
  auth_scope: repo
  base_url: https://decap-proxy2.guilherme11-gr.workers.dev
  debug: true

# pasta onde o CMS grava as imagens padrão
media_folder: "public/imgs"
public_folder: "/imgs"

collections:

  # ============================
  # CATEGORIES (sem alteração)
  # ============================
  - name: "categories"
    label: "Categorias"
    files:
      - file: "src/data/categories.json"
        label: "Lista de Categorias"
        name: "categories"
        fields:
          - label: "Categorias"
            name: "categories"
            widget: list
            summary: "{{name}}"
            collapsed: true
            fields:
              - { label: "ID",    name: "id",    widget: "number" }
              - { label: "Nome",  name: "name",  widget: "string" }
              - { label: "Slug",  name: "slug",  widget: "string" }
              - { label: "Carousel", name: "carousel", widget: "boolean" }
              - label: "Subcategorias"
                name: "categories"
                widget: list
                summary: "{{name}}"
                collapsed: true
                fields:
                  - { label: "ID",   name: "id",   widget: "number" }
                  - { label: "Nome", name: "name", widget: "string" }
                  - { label: "Slug", name: "slug", widget: "string" }

  # ============================
  # IMAGENS (sem alteração)
  # ============================
  - name: "images"
    label: "Imagens"
    files:
      - file: "src/data/images.json"
        label: "Lista de Imagens"
        name: "images"
        fields:
          - label: "Imagens"
            name: "images"
            widget: list
            summary: "{{id}} – {{image}}"
            collapsed: true
            fields:
              - { label: "ID",        name: "id",         widget: "number" }
              - { label: "Imagem",    name: "image",      widget: "image" }
              - { label: "Product ID",name: "product_id", widget: "number" }

  # ============================
  # PRODUTOS (folder collection)
  # ============================
  - name: "products"
    label: "Produtos"
    identifier_field: "slug"
    folder: "src/data/products"
    create: true
    slug: "{{slug}}"
    extension: "json"
    search: true
    # upload vai para public/imgs/products
    media_folder: "/public/imgs/products"
    # referência no JSON começa com /imgs/products
    public_folder: "/imgs/products"

    view_filters:
      - label: "Nome"
        field: "name"
        pattern: ".*"
      - label: "Slug"
        field: "slug"
        pattern: ".*"
      - label: "Categoria"
        field: "categorySlugs"
        pattern: ".*"

    fields:
      - { label: "ID",        name: "id",       widget: "number", required: true }
      - { label: "Código",    name: "code",     widget: "string", required: true }
      - { label: "Nome",      name: "name",     widget: "string", required: true }
      - { label: "Slug",      name: "slug",     widget: "string", required: true }
      - { label: "Preço",     name: "price",    widget: "number", required: true }
      - { label: "Destaque?", name: "featured", widget: "boolean" }
      - { label: "Descrição", name: "description", widget: "text" }

      - label: "Categorias"
        name: "categorySlugs"
        widget: "list"
        field:
          label: "Slug de Categoria"
          name: "slug"
          widget: "relation"
          collection: "categories"
          value_field: "slug"
          display_fields: ["name"]
          search_fields: ["name"]

      - label: "Imagens"
        name: "images"
        widget: "list"
        summary: "{{image}}"
        fields:
          - { label: "Imagem", name: "image", widget: "image" }

    summary: "{{name}} — R$ {{price}}"
